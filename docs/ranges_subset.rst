Subsetting Ranges
=================

There are many ways to subset a PyRanges object. Each returns a new PyRanges object and does not change the old one.

.. code-block:: python

   import pandas as pd
   import pyranges as pr

   gr = pr.load_dataset("chipseq")

   # +--------------+----------+----------+--------+---------+----------+
   # | Chromosome   | Start    | End      | Name   | Score   | Strand   |
   # |--------------+----------+----------+--------+---------+----------|
   # | chr1         | 1325303  | 1325328  | U0     | 0       | -        |
   # | chr1         | 1541598  | 1541623  | U0     | 0       | +        |
   # | chr1         | 1599121  | 1599146  | U0     | 0       | +        |
   # | ...          | ...      | ...      | ...    | ...     | ...      |
   # | chrY         | 21910706 | 21910731 | U0     | 0       | -        |
   # | chrY         | 22054002 | 22054027 | U0     | 0       | -        |
   # | chrY         | 22210637 | 22210662 | U0     | 0       | -        |
   # +--------------+----------+----------+--------+---------+----------+
   # PyRanges object with 10000 sequences from 24 chromosomes.


Chromosome only
~~~~~~~~~~~~~~~

.. code-block:: python

   gr["chrX"]

   # +--------------+-----------+-----------+--------+---------+----------+
   # | Chromosome   | Start     | End       | Name   | Score   | Strand   |
   # |--------------+-----------+-----------+--------+---------+----------|
   # | chrX         | 4589627   | 4589652   | U0     | 0       | +        |
   # | chrX         | 5044527   | 5044552   | U0     | 0       | -        |
   # | chrX         | 7704392   | 7704417   | U0     | 0       | +        |
   # | ...          | ...       | ...       | ...    | ...     | ...      |
   # | chrX         | 153255924 | 153255949 | U0     | 0       | -        |
   # | chrX         | 153632850 | 153632875 | U0     | 0       | +        |
   # | chrX         | 153874106 | 153874131 | U0     | 0       | +        |
   # +--------------+-----------+-----------+--------+---------+----------+
   # PyRanges object with 282 sequences from 1 chromosomes.

Chromosome and Strand
~~~~~~~~~~~~~~~~~~~~~

.. code-block:: python

   gr["chrX", "-"]

   # +--------------+-----------+-----------+--------+---------+----------+
   # | Chromosome   | Start     | End       | Name   | Score   | Strand   |
   # |--------------+-----------+-----------+--------+---------+----------|
   # | chrX         | 5044527   | 5044552   | U0     | 0       | -        |
   # | chrX         | 11036800  | 11036825  | U0     | 0       | -        |
   # | chrX         | 12288327  | 12288352  | U0     | 0       | -        |
   # | ...          | ...       | ...       | ...    | ...     | ...      |
   # | chrX         | 151277790 | 151277815 | U0     | 0       | -        |
   # | chrX         | 153037423 | 153037448 | U0     | 0       | -        |
   # | chrX         | 153255924 | 153255949 | U0     | 0       | -        |
   # +--------------+-----------+-----------+--------+---------+----------+
   # PyRanges object with 151 sequences from 1 chromosomes.


Chromosome and Slice
~~~~~~~~~~~~~~~~~~~~~

.. code-block:: python

   gr["chrX", 150000000:160000000]

   # +--------------+-----------+-----------+--------+---------+----------+
   # | Chromosome   | Start     | End       | Name   | Score   | Strand   |
   # |--------------+-----------+-----------+--------+---------+----------|
   # | chrX         | 150277236 | 150277261 | U0     | 0       | -        |
   # | chrX         | 151277790 | 151277815 | U0     | 0       | -        |
   # | chrX         | 151324943 | 151324968 | U0     | 0       | +        |
   # | ...          | ...       | ...       | ...    | ...     | ...      |
   # | chrX         | 153255924 | 153255949 | U0     | 0       | -        |
   # | chrX         | 153632850 | 153632875 | U0     | 0       | +        |
   # | chrX         | 153874106 | 153874131 | U0     | 0       | +        |
   # +--------------+-----------+-----------+--------+---------+----------+
   # PyRanges object with 8 sequences from 1 chromosomes.

Chromosome, Strand and Slice
~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. code-block:: python

   gr["chrX", "-", 150000000:160000000]

   # +--------------+-----------+-----------+--------+---------+----------+
   # | Chromosome   |     Start |       End | Name   |   Score | Strand   |
   # |--------------+-----------+-----------+--------+---------+----------|
   # | chrX         | 150277236 | 150277261 | U0     |       0 | -        |
   # | chrX         | 151277790 | 151277815 | U0     |       0 | -        |
   # | chrX         | 153037423 | 153037448 | U0     |       0 | -        |
   # | chrX         | 153255924 | 153255949 | U0     |       0 | -        |
   # +--------------+-----------+-----------+--------+---------+----------+
   # PyRanges object with 4 sequences from 1 chromosomes.

Slice
~~~~~

Only using slices returns all ranges from all chromosomes and strands within those coordinates.

.. code-block:: python

   gr[0:100000]

   # +--------------+---------+-------+--------+---------+----------+
   # | Chromosome   |   Start |   End | Name   |   Score | Strand   |
   # |--------------+---------+-------+--------+---------+----------|
   # | chr2         |   13611 | 13636 | U0     |       0 | -        |
   # | chr2         |   32620 | 32645 | U0     |       0 | -        |
   # | chr2         |   33241 | 33266 | U0     |       0 | +        |
   # | chr3         |   87179 | 87204 | U0     |       0 | +        |
   # | chr4         |   45413 | 45438 | U0     |       0 | -        |
   # +--------------+---------+-------+--------+---------+----------+
   # PyRanges object with 5 sequences from 3 chromosomes.

Strand
~~~~~~

.. code-block:: python

   gr["+"]

   # +--------------+----------+----------+--------+---------+----------+
   # | Chromosome   | Start    | End      | Name   | Score   | Strand   |
   # |--------------+----------+----------+--------+---------+----------|
   # | chr1         | 1541598  | 1541623  | U0     | 0       | +        |
   # | chr1         | 1599121  | 1599146  | U0     | 0       | +        |
   # | chr1         | 3504032  | 3504057  | U0     | 0       | +        |
   # | ...          | ...      | ...      | ...    | ...     | ...      |
   # | chrY         | 12930373 | 12930398 | U0     | 0       | +        |
   # | chrY         | 15548022 | 15548047 | U0     | 0       | +        |
   # | chrY         | 21559181 | 21559206 | U0     | 0       | +        |
   # +--------------+----------+----------+--------+---------+----------+
   # PyRanges object with 5050 sequences from 24 chromosomes.


Slice and Strand
~~~~~~~~~~~~~~~~

.. code-block:: python

   gr["+", 0:100000]

   # +--------------+---------+-------+--------+---------+----------+
   # | Chromosome   |   Start |   End | Name   |   Score | Strand   |
   # |--------------+---------+-------+--------+---------+----------|
   # | chr2         |   33241 | 33266 | U0     |       0 | +        |
   # | chr3         |   87179 | 87204 | U0     |       0 | +        |
   # +--------------+---------+-------+--------+---------+----------+
   # PyRanges object with 2 sequences from 2 chromosomes.

.. [#] But under the hood a range object has associated high-performance datastructures to support overlapping operations and slicing.
